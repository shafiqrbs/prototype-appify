{"version":3,"file":"nprogress.store.js","sources":["../src/nprogress.store.ts"],"sourcesContent":["import { clamp } from '@mantine/hooks';\nimport { createStore, useStore, MantineStore } from '@mantine/store';\n\nfunction getIntervalProgressValue(currentProgress: number) {\n  let next = 0.5;\n\n  if (currentProgress >= 0 && currentProgress <= 20) {\n    next = 10;\n  } else if (currentProgress >= 20 && currentProgress <= 50) {\n    next = 4;\n  } else if (currentProgress >= 50 && currentProgress <= 80) {\n    next = 2;\n  } else if (currentProgress >= 80 && currentProgress <= 99) {\n    next = 1;\n  } else if (currentProgress >= 99 && currentProgress <= 100) {\n    next = 0;\n  }\n\n  return currentProgress + next;\n}\n\nexport interface NprogressState {\n  mounted: boolean;\n  progress: number;\n  interval: number;\n  step: number;\n  stepInterval: number;\n  timeouts: number[];\n}\n\nexport type NprogressStore = MantineStore<NprogressState>;\n\nexport const createNprogressStore = () =>\n  createStore<NprogressState>({\n    mounted: false,\n    progress: 0,\n    interval: 0,\n    step: 1,\n    stepInterval: 100,\n    timeouts: [],\n  });\n\nexport const useNprogress = (store: NprogressStore) => useStore(store);\n\nexport function updateNavigationProgressStateAction(\n  update: (state: NprogressState) => Partial<NprogressState>,\n  store: NprogressStore\n) {\n  const state = store.getState();\n  store.setState({ ...state, ...update(store.getState()) });\n}\n\nexport function decrementNavigationProgressAction(store: NprogressStore) {\n  updateNavigationProgressStateAction(\n    (state) => ({ progress: Math.max(state.progress - state.step, 0) }),\n    store\n  );\n}\n\nexport function setNavigationProgressAction(value: number, store: NprogressStore) {\n  updateNavigationProgressStateAction(\n    () => ({ progress: clamp(value, 0, 100), mounted: true }),\n    store\n  );\n}\n\nexport function cleanupNavigationProgressAction(store: NprogressStore) {\n  updateNavigationProgressStateAction((state) => {\n    window.clearInterval(state.interval);\n    state.timeouts.forEach((timeout) => window.clearTimeout(timeout));\n    return { timeouts: [] };\n  }, store);\n}\n\nexport function completeNavigationProgressAction(store: NprogressStore) {\n  cleanupNavigationProgressAction(store);\n\n  updateNavigationProgressStateAction((state) => {\n    const mountedTimeout = window.setTimeout(() => {\n      updateNavigationProgressStateAction(() => ({ mounted: false }), store);\n    }, 50);\n\n    const resetTimeout = window.setTimeout(() => {\n      updateNavigationProgressStateAction(() => ({ progress: 0 }), store);\n    }, state.stepInterval + 50);\n\n    return { progress: 100, timeouts: [mountedTimeout, resetTimeout] };\n  }, store);\n}\n\nexport function startNavigationProgressAction(store: NprogressStore) {\n  updateNavigationProgressStateAction(\n    (s) => ({ progress: getIntervalProgressValue(s.progress), mounted: true }),\n    store\n  );\n\n  updateNavigationProgressStateAction((state) => {\n    window.clearInterval(state.interval);\n\n    const interval = window.setInterval(() => {\n      updateNavigationProgressStateAction(\n        (s) => ({ progress: getIntervalProgressValue(s.progress), mounted: true }),\n        store\n      );\n    }, state.stepInterval);\n\n    return { interval, mounted: true };\n  }, store);\n}\n\nexport function stopNavigationProgressAction(store: NprogressStore) {\n  updateNavigationProgressStateAction((state) => {\n    window.clearInterval(state.interval);\n    return { interval: -1 };\n  }, store);\n}\n\nexport function resetNavigationProgressAction(store: NprogressStore) {\n  cleanupNavigationProgressAction(store);\n  stopNavigationProgressAction(store);\n  updateNavigationProgressStateAction(() => ({ progress: 0, mounted: false }), store);\n}\n\nexport function incrementNavigationProgressAction(store: NprogressStore) {\n  updateNavigationProgressStateAction((state) => {\n    const nextValue = Math.min(state.progress + state.step, 100);\n    const nextMounted = nextValue !== 100 && nextValue !== 0;\n\n    if (!nextMounted) {\n      const timeout = window.setTimeout(\n        () => resetNavigationProgressAction(store),\n        state.stepInterval + 50\n      );\n\n      return {\n        progress: nextValue,\n        mounted: nextMounted,\n        timeouts: [...state.timeouts, timeout],\n      };\n    }\n\n    return {\n      progress: nextValue,\n      mounted: nextMounted,\n    };\n  }, store);\n}\n\nexport function createNprogress() {\n  const store = createNprogressStore();\n  const actions = {\n    start: () => startNavigationProgressAction(store),\n    stop: () => stopNavigationProgressAction(store),\n    reset: () => resetNavigationProgressAction(store),\n    set: (value: number) => setNavigationProgressAction(value, store),\n    increment: () => incrementNavigationProgressAction(store),\n    decrement: () => decrementNavigationProgressAction(store),\n    complete: () => completeNavigationProgressAction(store),\n    cleanup: () => cleanupNavigationProgressAction(store),\n  };\n\n  return [store, actions] as const;\n}\n\nexport const [nprogressStore, nprogress] = createNprogress();\nexport const {\n  start: startNavigationProgress,\n  stop: stopNavigationProgress,\n  reset: resetNavigationProgress,\n  set: setNavigationProgress,\n  increment: incrementNavigationProgress,\n  decrement: decrementNavigationProgress,\n  complete: completeNavigationProgress,\n  cleanup: cleanupNavigationProgress,\n} = nprogress;\n"],"names":["createStore","store","useStore","clamp"],"mappings":"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"}